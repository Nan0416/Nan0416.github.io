<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>C++&nbsp;Function Pointer</title>
<meta charset="utf-8">
<meta name="date" content="2018-01-29">
<meta name="keywords" content="function&nbsp;pointer">
<meta name="keywords" content="c++">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/XRegExp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shCore.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushCpp.js"></script>
<link href="../../syntaxHighlight_css_c/shCore.css" rel="stylesheet" type="text/css" />
<link href="../../syntaxHighlight_css_c/shThemeDefault.css" rel="stylesheet" type="text/css" />



</head>
<body>
<script>
SyntaxHighlighter.config.strings.expandSource = '+ expand source';
SyntaxHighlighter.config.strings.help = '?';
SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
SyntaxHighlighter.defaults['pad-line-numbers'] = false;
SyntaxHighlighter.defaults['toolbar'] = false;
SyntaxHighlighter.all()
</script>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<strong>C++&nbsp;-&nbsp;Function pointer</strong>
</div>
<p class="date"><span class="created-date">Created:2018-01-29</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-01-29</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#fpIntro">Introduction</a></li>
<li><a href="#fpExample">Examples</a></li>
<li><a href="#fpReference">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
        cannot create a non-constant pointer to member function
<div class="content" id="fpIntro">
<h3>Introduction</h3>
<p>A function pointer is just like a variable pointer.</p>
<p>But function only has referent (pointer) type; or r-value</p>
<div class="generalTable">
<table>
<tr><th>Operation</th><th>Function</th><th>Data</th></tr>
<tr><td>declaration &amp; definition</td><td>int inc(int a){return ++a; }</td><td>int a = 1;</td></tr>
<tr><td>value type</td><td>int (int)</td><td>int</td></tr>
<tr><td>value declaration</td><td><span style="color:red">int f(int); //is not assignable</span></td><td>int a;</td></tr>
<tr><td>pointer type</td><td>int (*)(int)</td><td>int *</td></tr>
<tr><td>pointer declaration</td><td>int (*f) (int);</td><td>int * b;</td></tr>
<tr><td>pointer assignment</td><td>f = &amp;inc;</td><td>b = &amp;a;</td></tr>
<tr><td>call by pointer</td><td>call(int (*f)(int);</td><td>call(int * b);</td></tr>
<tr><td>call by value</td><td><span style="color:red">call(int f(int)); // it looks like call by value, but it is still call-by-pointer</span></td><td>call(int b);</td></tr>
<tr><td>call</td><td>(*f)(10); &lt;=&gt; f(10)</td><td>(*b);</td></tr>

</table>
</div>
<h4>Class member function and non-member (free) function</h4>
<p>Each C++ global function and class member function just has one copy of code in .text section. Even if we create 10 object of a certain class, these objects function is just a reference to the text section instead a new copy of the code.
</p>
<h4>Member function type</h4>
<p>Member function is different from a non-member function because it implicitly gives an extra argument "this" to the member function.</p>
<div class="featureList">
<p>Declare a member function will become e.g. void (Class::*fp)(void)</p>
<p>Assign: fp = &amp;F::func; // at this time, it binds to a member function</p>
<p>Call this function: we have to via an object (object.*fp)(), this object's this will be given to this function.</p>
</div>

</div>
</li>
<li>
<div class="content" id="fpExample">
<h3>Examples</h3>
<div class="featureList">
    <ol>
        <li>
<h4>non-member (free) function</h4>
<p><a href="./program/functionPointer.cpp">Source code</a></p>
<pre class="brush: cpp">
#include &lt;iostream>
using namespace std;


int (*f)(int);
int * b;
int inc(int a){
    static int counter = 0; // test if the function is copied when "call by value"
    cout &lt;&lt; "static counter " &lt;&lt;  ++counter &lt;&lt; endl;
    cout &lt;&lt; "input value " &lt;&lt; a &lt;&lt; endl;
    return ++a;
}
int a = 1;

class F{
public:
    void callDataRef(int *);
    void callFunRef(int (*)(int));
    
    void callDataCopy(int);
    void callFunCopy(int (int));
    
};
void F::callDataRef(int *a){
    cout &lt;&lt; "call data ref " &lt;&lt;  *a &lt;&lt; endl;
}
void F::callFunRef(int (*f)(int)){
    // int x = f(1); same as following, only reference type.
    int x = (*f)(1);
    cout &lt;&lt; "call func ref " &lt;&lt; x &lt;&lt; endl;
}
void F::callDataCopy(int a){
    cout &lt;&lt; "call data copy (value) " &lt;&lt; a &lt;&lt; endl;
}
void F::callFunCopy(int f(int)){
    int x = f(1);
    cout &lt;&lt; "call func val " &lt;&lt; x &lt;&lt; endl;
    
}
F e;
int main(){
    //assignment
    b = &a;
    f = &inc;
    e.callFunCopy(inc); // the function is not copied because the static variable still has one.
    e.callFunCopy(inc);
    e.callFunRef(inc);
    
    

}

</pre>
</li>
<li>
<h4>Class member function example</h4>
<p><a href="./program/classMemberPointer.cpp">Source code</a></p>
<pre class="brush:cpp">

#include &lt;iostream>
using namespace std;
class F{
public:
    int x;
    string s;
    F(string s, int x);
    void inc(void);
};
F::F(string s, int x){
    this->s = s;
    this->x = x;
}
void F::inc(void){
    static int temp = 0;
    ++x;
    cout &lt;&lt; "call " &lt;&lt; s &lt;&lt; " " &lt;&lt; ++temp &lt;&lt; "th with x = " &lt;&lt;  x &lt;&lt; endl;
}
void (F::*fp)(void);
int main(){
    F f("F", 0), g("G", 0);
    f.inc(); //call F 1th with x = 1
    f.inc(); //call F 2th with x = 2
    int * i = &amp;(f.x);
    (*i)++;
    f.inc(); //call F 3th with x = 4
    g.inc(); //call G 4th with x = 1
    fp = &amp;F::inc;
    (g.*fp)(); //call G 5th with x = 2
}

</pre>
    </li>
    </ol>
    </div>
</div>
</li>
<li>
<div class="content" id="fpReference">
<h3>References</h3>
<div class="featureList">
    <ol>
        <li><a href="https://stackoverflow.com/questions/15035905/setting-a-pointer-to-a-non-static-member-function" target="_blank">C++ error: Cannot create a non-constant pointer to member function.</a></li>
    </ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
