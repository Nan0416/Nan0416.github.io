<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>System&nbsp;Reset</title>
<meta name="date" content="2017-12-28">
<meta name="keywords" content="reset">
<meta name="keywords" content="atmega328p">
<meta name="keywords" content="microcontroller">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>System&nbsp;-&nbsp;System&nbsp;reset</strong></center>
</div>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#resetIntro">Reset Introduction</a></li>
<li><a href="#resetSources">Reset sources</a></li>
<li><a href="#resetReferences">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="resetIntro">
<p>A reset source happens, a time-out delay is followed to make sure the power is stable. Next, it enters the reset process, all I/O registers are set to their inital values by hardware, 
then the MCU starts from the reset vector and jumps to the reset routine. (The location of reset routine is controlled by the High Fuse.BOOTRST). 
</p>
<p>There are four different reset sources discussed in the following section. The MCU can know which source causes it to reset by checking the MCU Status Register (MCUSR) at the beginning of its program.</p>
<div class="register">
<h4>MCU Status Register</h4>
<table>
<tr><th>No.</th><th>Name</th><th>Meaning</th><th>Default value</th></tr>
<tr><td>3</td><td>WDRF</td><td>Watchdog System Reset Flag: This bit is set if a watchfog system reset occurs. The reset routine can use this bit to detect which reset source causes the reset.</td><td>0</td></tr>
<tr><td>2</td><td>BORF</td><td>BOD reset flag</td><td>0</td></tr>
<tr><td>1</td><td>EXTRF</td><td>External reset flag</td><td>0</td></tr>
<tr><td>0</td><td>PORF</td><td>Power-on reset flag</td><td>0</td></tr>
</table>
<p class="starMark">* The developer should read and then clear the MCUSR as early as possible. If another reset happens before resetting (clearing) this register, the source would not be identified.</p>
</div>
</div>
</li>
<li>
<div class="content" id="resetSources">
<h3>Reset sources</h3>
<div class="featureList">
<ol>
<li>
<p><span style="font-weight:bold";>External Reset</span>: a low level is present on the ~RESET (PC6) for longer than the minimum pulse length. The pulse length is not claimed as a certain value.
The external reset can be closed by High Fuse.RSTDISBL bit = 0 (programmed)</p>
<p>Arduino uses DTR to reset the MCU via this external reset. To avoid this feature, we can disable the external reset by modifying the fuse bit. For example, we have to use an external 10uF to avoid the auto-reset when using an Arduino based ISP.
With the external reset disabled, this cap is not necessary.
</p>
<div class="featureList">
<h4>Arduino disables DTR reset</h4>
<p>Resource: two Arduino Nano, one 10 uF cap</p>
<ol>
<li>Upload the Arduino ISP to Arduino Nano A and Arduino Nano B.</li>
<li>10uF cap connects Arduino Nano A's GND and RST.</li>
<li>Connection:
<div class="connection">
<table>
<tr><th>Master/Arduino Nano Programmer A</th><th>Slave/Arduino Nano B</th></tr>
<tr><td>SCK (PB5, d13)</td><td>SCK (PB5, d13)</td></tr>
<tr><td>MISO (PB4, d12)</td><td>MISO (PB4, d12)</td></tr>
<tr><td>MOSI (PB3, d11)</td><td>MOSI (PB3, d11)</td></tr>
<tr><td>~SS (PB2, d10)</td><td>reset (RST)</td></tr>
<tr><td>Vcc</td><td>Vcc</td></tr>
<tr><td>GND</td><td>GND</td></tr>
</table>
</div>
</li>
<li>Disable Arduino B's external reset.</li>
<li>Run<p><span class="cmd">avrdude -p m328p -c stk500v1 -b 19200 -P /dev/ttyUSB0 -U hfuse:w:0x5a:m</span></p></li>
</ol>
<p>Now, the Arduino Nano B is an Arduino based ISP that does not need an extra cap.</p>
</div>
</li>
<li>
<p><span style="font-weight:bold;">Power-on Reset</span>: generate by an On-chip detection circuit. When the Vcc rises above the Vpot, the reset is triggered.</p>
</li>
<li><p><span style="font-weight:bold;">BOD reset</span>: different from Power-on Reset, the trigger level has a hysteresis feature.</p></li>
<li><p><span style="font-weight:bold;">Watchdog reset</span>: See <a href="./watchdog.html">Watchdog</a>.</p></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
