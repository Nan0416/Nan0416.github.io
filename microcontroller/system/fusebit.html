<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>Fuse&nbsp;bits</title>
<meta name="date" content="2017-12-27">
<meta name="keywords" content="microcontroller">
<meta name="keywords" content="fusebit">
<meta name="keywords" content="atmega">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<style>

</style>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>System&nbsp;-&nbsp;Fuse&nbsp;bits</strong></center>
</div>

<div class="catalog">
<ul class="catalogItems">
<li><a href="#fusebits_def">What are fuse bits?</a></li>
<li><a href="#fusebits_in_atmega328">Fuse bits in Atmega328/p</a></li>
<li><a href="#fusebits_setting">How to set fuse bits?</a></li>
<li><a href="#fusebits_resources">Resource</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="fusebits_def">
<h3>What are fuse bits?</h3>
<p>Fuse bits are a few bits stored in some special flash memory area. They are used to configure the how the chip will behave when powering on. (e.g. initilize system register to different value.)
It is also said to be hardware set compared to software set by changing registers. For example, it can determine whether the chip has a bootloader, 
what speed (clock source) and voltage it is going to run at. Moreover, the status of the Fuse bits is not affected by Chip Erase.</p>
<div class="termnology">
<h4>Terms</h4>
<ul>
<li>programmed: when saying a bit is programmed, it is equvilent to claim a bit is set. But it is written to 0 to be set.</li>
<li>unprogrammed: unset by written to 1.</li>
</ul>
</div>
</div>
</li>
<li>
<div class="content" id="fusebits_in_atmega328">
<h3>Fuse bits in Atmega328/p</h3>
<p>
The device has three Fuse bytes. Extended fuse bytes (contains 3 fuse bits), fuse high bytes (contains 8 fuse bits), and fuse low byte (contains 
8 fuse bits).
</p>
<div class="register">
<h4>Extended Fuse byte</h4>
<p class="registerComment">Extended fuse bits are used to configure the BOD circuit (a internal circuit that guarantees a enough time-out delay for stable Vcc).
    Moreover, BOD would reset the MCU if the Vcc is below the trigger voltage. There are three reference voltage levels for triggering the device. The low three bits in 
    the extended fuse byte are defined and used to specify the trigger voltage level. Atmega328p's trigger voltage efuse[2:0] = 111 (BOD disabled), 110 (1.8V), 101 (2.7V),
     100 (4.3V), others (reserved)</p>
<table class="registerDesc">
<tr><th>No.</th><th>Name</th><th>Meaning</th><th>Default value</th></tr>
<tr><td>2</td><td>BODLEVEL2</td><td></td><td>1 (unprogrammed/unset)</td></tr>
<tr><td>1</td><td>BODLEVEL1</td><td></td><td>1</td></tr>
<tr><td>0</td><td>BODLEVEL0</td><td>Brown-out Detector trigger levels set the BOD reference voltage.</td><td>1</td></tr>
</table>
<p class="registerComment"></p>
</div>
<div class="register">
<h4>High Fuse byte</h4>
<p class="registerComment">The high fuse byte enables/disables of the external reset, debugWIRE, serial program downloading, watchdog timer, 
and controls the behavior of EEPROM, the location of reset vector and the size of boot section.</p>
<table class="registerDesc">
<tr><th>No.</th><th>Name</th><th>Meaning</th><th>Default value</th></tr>
<tr><td>7</td><td>RSTDISBL</td><td>external reset disable</td><td>1 (unprogrammed/unset)</td></tr>
<tr><td>6</td><td>DWEN</td><td>debugWIRE enable</td><td>1</td></tr>
<tr><td>5</td><td>SPIEN</td><td>Enable serial program and data downloading</td><td>0 (programmed/set)</td></tr>
<tr><td>4</td><td>WDTON</td><td>Watchdog timer is always on and works in reset mode</td><td>1</td></tr>
<tr><td>0</td><td>BOOTRST</td><td> = 1 (unprogrammed) the reset vector is at the begining of the application code, otherwise at the beginning of boot section.</td><td>1 (arduino = 0)</td></tr>
</table>
<p class="registerComment"></p>
</div>
<div class="register">
<h4>Low Fuse byte</h4>
<p class="registerComment">Low fuse byte contains 8 fuse bits. They are primarily used to configure the <mark>system clock</mark>, such as clock source, start-up time, and divided by 8.</p>
<table class="registerDesc">
<tr><th>No.</th><th>Name</th><th>Meaning</th><th>Default value</th></tr>
<tr><td>7</td><td>CKDIV8</td><td>Divide the clock source frequency by 8</td><td>0 (programmed/set)</td></tr>
<tr><td>6</td><td>CKOUT</td><td>Output the clock signal in the CLKO (PB0 pin)</td><td>1 (unprogrammed/unset)</td></tr>
<tr><td>5</td><td>SUT1</td><td></td><td>1</td></tr>
<tr><td>4</td><td>SUT0</td><td>SUT1 and SUT0 set the minimum #cycles required for a stable clock (default is the max start-up time for default clock source)</td><td>0</td></tr>
<tr><td>3</td><td>CKSEL3</td><td></td><td>0</td></tr>
<tr><td>2</td><td>CKSEL2</td><td></td><td>0</td></tr>
<tr><td>1</td><td>CKSEL1</td><td></td><td>1</td></tr>
<tr><td>0</td><td>CKSEL0</td><td>CKSELn select the clock source (default 0010 internal 8MHz RC)</td><td>0</td></tr>
</table>
<p class="registerComment">The CKDIV8 bit's principle is to modify the Clock Prescaler Register (CLKPR) to divided the frequency by 8. In other words, if the CKDIV8 is programmed, then the initial value of CLKPR is 0x03.</p>
</div>
</div>
</li>
<li>
<div class="content" id="fusebits_setting">
<h3>How to set fuse bits?</h3>
<div class="featureList">
<h4>Attention</h4>
<ol>
<li>Cannot directly modify the fuse bit via arduino bootloader. A ISP programmer has to be used.</li>
<li>When using an Arduino as ISP, a 10uF cap is needed to connect GND and RST.</li>
</ol>
</div>
<div class="featureList">
<h4>Read arduino fuse bit</h4>
<p>Resource: two Arduino Nano, one 10 uF cap</p>
<ol>
<li>Upload the Arduino ISP to Arduino Nano A.</li>
<li>10uF cap connects Arduino Nano A's GND and RST.</li>
<li>Connection:
<div class="connection">
<table>
<tr><th>Master/Arduino Nano Programmer A</th><th>Slave/Arduino Nano B</th></tr>
<tr><td>SCK (PB5, d13)</td><td>SCK (PB5, d13)</td></tr>
<tr><td>MISO (PB4, d12)</td><td>MISO (PB4, d12)</td></tr>
<tr><td>MOSI (PB3, d11)</td><td>MOSI (PB3, d11)</td></tr>
<tr><td>~SS (PB2, d10)</td><td>reset (RST)</td></tr>
<tr><td>Vcc</td><td>Vcc</td></tr>
<tr><td>GND</td><td>GND</td></tr>
</table>
</div>
</li>
<li>Arduino IDE burns bootloader to Arduino Nano B.</li>
<li>Run<p><span class="cmd">avrdude -p m328p -c stk500v1 -b 19200 -P /dev/ttyUSB0 -v #v stands for verbose</span></p></li>
</ol>
<p>Result E: 0xFD, H:0xDA, L:0xFF</p>
</div>
</div>
</li>
<li>
<div class="content" id="fusebits_resources">
<h3>Resources</h3>
<div class="featureList">
<ol>
<li><a href="http://www.engbedded.com/fusecalc/" target="_blank">Fuse bits calculator</a></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
</body>
</html>
