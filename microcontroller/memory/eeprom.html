<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>Memory&nbsp;EEPROM</title>
<meta charset="utf-8">
<meta name="date" content="2018-01-22">
<meta name="keywords" content="power">
<meta name="keywords" content="atmega328p">
<meta name="keywords" content="microcontroller">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>Memory&nbsp;-&nbsp;EEPROM</strong></center>
</div>
<p class="date"><span class="created-date">Created:2018-01-22</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-01-22</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#eepromIntro">Introduction</a></li>
<li><a href="#eepromHistory">Memory history</a></li>
<li><a href="#eepromAVR">AVR built-in EEPROM</a></li>
<li><a href="#eepromDetails">Programming Details</a></li>
<li><a href="#eepromExample">Example</a></li>
<li><a href="#eepromReferences">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="eepromIntro">
<h3>Introduction</h3>
<p>EEPROM (Electrically erasable programmable read-only memory): an non-volatile memory that allowed individual bytes (modern EEPROM allowing a block) to be erased and wrote.</p>
<p>It usually has an about 1,000,000 erasing life-time.</p>
<p>Before writing a byte to it, the byte has to be erased.</p>
<h4>Internal structure</h4>
<p>Internally, EEPROM is organized as an array of floating-gate transistors (MOSFET).</p>
</div>
</li>
<li>
<div class="content" id="eepromHistory">
<h3>Memory history</h3>
<div class="featureList">
<ol>
<li>ROM: Read Only Memory: the logic gate circuit is cut when producing. Data cannot be updated.</li>
<li>EPROM: Erasable Programmable ROM: it can be erased by exposing to strong ultraviolet light<p><img src="./img/eprom.jpg" width="200" height="90">[1]</p></li>
<li>EEPROM: data is erased by electrical signal instead of light.</li>
</ol>
</div>
</div>
</li>
<li>
<h3>AVR built-in EEPROM</h3>
<div class="featureList">
<h4>EEPROM in atmega328p</h4>
<ol>
<li>1K bytes (2^10)</li>
<li>at least 100,000 write/erase</li>
<li>separate address space</li>
<li>manuiplate on single byte each time</li>
<li>manuiplation is done by using EEPROM peripheral registers</li>
</ol>
</div>
<div class="featureList">
<h4>Operating sequence</h4>
<p>Operation on the EERPOM must follow a special procedure.</p>
<p>Four registers: EECR, EEPROM control register; EEDR. EEPROM data register; EEARL and EEARH, EEPROM address register low and high</p>
<ol>
<li>Wait until EEPE becomes zero. (clear by hardware after finishing one operation)</li>
<li>Wait until SPMEN in SPMCSR becomes zero.* (only consider in bootloader)</li>
<li>Prepare address, data and operation mode(optional): Write new EEPROM address to EEAR, new EEPROM data to EEDR, and set mode EEPM[1:0]</li>
<li>Set EEMPE bit while clearing EEPE in EECR.</li>
<li>Within four clock cycles after setting EEMPE, set EEPE.</li>-
</ol>
</div>
</li>
<li>
<div class="eepromDetails">
<h3>Programming Details: Writing/Erasing</h3>
<p>The erasing/writing process takes 1.8ms or 3.4ms, but CPU only implements one instruction and halt for two cycles. So the job is primarily done without CPU inference. But notices, data is not avaiable after CPU is waken.</p>
<h4>EEPE: a write strobe</h4>
<p>EEPE bit is set by software to lanuch a operation, and cleared by hardware after finising an operation. Software can use the bit as a polling bit.</p>
<h4>EEPROM Master Write Enable time-out</h4>
<p>An interrupt coming between set EEMPE and EEPE. If the interrupt routine also accesses the EEPROM, the the EEDR and EEAR would be modified. Their values would also keep changed after returning from the interrupt routine.</p>
<p>Therefore, disable global interrupt during the two operations.</p>
<h4>Halting CPU</h4>
<p>When EEPE has been set, the CPU is halted for two cycles before the next instruction is executed</p>
<h4>Interrupt</h4>
<p>EERIE: a constant interrupt when EEPE is clear (by hardware, which indicates the complete of one operation). The interrupt will not be generated during EEPROM write or SPM. The EEPROM write operation takes 1.8ms or 3.4ms. The process is like finished in background, because CPU is only halt for 2 cycles.</p>
<h4>The EEPROM can not be programmed during a CPU write to the Flash memory</h4>
<p>The bootloader section code can program flash, but it is not allowed to write EEPROM when the writing flash is in process. Polling SPMEN.</p>
</div>
</li>
<li>
<div class="content" id="eepromExample">
<h3>Example</h3>
<p></p>
</div>
</li>
<li>
<div class="content" id="eepromReference">
<h3>References</h3>
<div class＝"featureList">
<ol>
<li><a href="https://en.wikipedia.org/wiki/EPROM#/media/File:EPROM_Intel_C1702A.jpg" target="_blank">EPROM picture</a></li>
<li><a href="./atmega328p.pdf" target="_blank">Atmega328p datasheet</a></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
