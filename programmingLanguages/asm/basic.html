<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>ASM&nbsp;Basic</title>
<meta charset="utf-8">
<meta name="date" content="2018-01-02">
<meta name="keywords" content="asm">
<meta name="keywords" content="basic">
<meta name="keywords" content="programming">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>



<script type="text/javascript" src="../../syntaxHighlight_js_c/XRegExp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shCore.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushCpp.js"></script>
<link href="../../syntaxHighlight_css_c/shCore.css" rel="stylesheet" type="text/css" />
<link href="../../syntaxHighlight_css_c/shThemeDefault.css" rel="stylesheet" type="text/css" />

</head>
<body>
<script>
SyntaxHighlighter.config.strings.expandSource = '+ expand source';
SyntaxHighlighter.config.strings.help = '?';
SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
SyntaxHighlighter.defaults['pad-line-numbers'] = false;
SyntaxHighlighter.defaults['toolbar'] = false;
SyntaxHighlighter.all()
</script>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>ASM&nbsp;-&nbsp;Basic</strong></center>
</div>
<p class="date"><span class="created-date">Created:2018-01-02</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-01-21</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#asmIntro">Introduction</a></li>
<li><a href="#asmExample">A simple assembly code</a></li>
<li><a href="#asmBasicReferences">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="asmIntro">
<h3>Introduction</h3>
<p>Assembly program: a specific instruction set + the assembly language syntax + the assembler pseudo-ops.</p>
<div class="featureList">
<ol>
<li>instruction set: A processor's jobs can be categorized as arithmetic, logical and control. To program a processor, we can only use the instruction 
set that support by the specific target processor. (e.g. Cortex-M3 only supports Thumb1/2, Atmega328p supports Atmel AVR instruction set) (不同processor family用不同instruction set, 就像不同地方人用不同的方言)</li>
<li>assembly language syntax: there exists several syntax, such as GAS (gnu-as AT&amp;T syntax), NASM (netwide assembler), and MASM (Microsoft assmler). For example, .equ DDRB, 0x10; GNU .equ DDRB =0x10; NASM</li>
<li>assembler pseudo-ops (directives): different assemblers have distinct directives.</li>
</ol>
<p>Even though there is no unique assembly code can be compiled and run directly in different devices, but the ideas and principles of assembly programming are same for all instruction set and syntax.</p>
<p>In this note, AT&amps;T syntax, GNU-AS and AVR 8-bit instruction set is used.</p>
</div>
</div>
</li>
<li>
<div class="content" id="asmExample">
<h3>A simple assembly code</h3>
<p><a href="./src/main.c">C source code</a>&nbsp;&nbsp;&nbsp;<a href="./src/main.s">Assembly source code</a></p>
<pre class="brush: cpp">
    #define F_CPU 16000000UL
    #include &lt;avr/io.h>
    int main(){
	    DDRB |= 0x20;
	    PORTB |= 0x20;
	    PORTB &amps;= 0xDF;
	    return 0;
    }
</pre>
<p><span class="cmd">avr-gcc  -mmcu=atmega328p -S  main.c # upper case S</span></p>
<div class="asm">
<pre>
        .file	"main.c"
        __SP_H__ = 0x3e
        __SP_L__ = 0x3d
        __SREG__ = 0x3f
        __tmp_reg__ = 0
        __zero_reg__ = 1
            .text
        .global	main
            .type	main, @function
        main:
            push r28
            push r29
            in r28,__SP_L__
            in r29,__SP_H__
        /* prologue: function */
        /* frame size = 0 */
        /* stack size = 2 */
        .L__stack_usage = 2
            ldi r24,lo8(36)
            ldi r25,0
            ldi r18,lo8(36)
            ldi r19,0
            movw r30,r18
            ld r18,Z
            ori r18,lo8(32)
            movw r30,r24
            st Z,r18
            ldi r24,lo8(37)
            ldi r25,0
            ldi r18,lo8(37)
            ldi r19,0
            movw r30,r18
            ld r18,Z
            ori r18,lo8(32)
            movw r30,r24
            st Z,r18
            ldi r24,lo8(37)
            ldi r25,0
            ldi r18,lo8(37)
            ldi r19,0
            movw r30,r18
            ld r18,Z
            andi r18,lo8(-33)
            movw r30,r24
            st Z,r18
            ldi r24,0
            ldi r25,0
        /* epilogue start */
            pop r29
            pop r28
            ret
            .size	main, .-main
            .ident	"GCC: (GNU) 4.9.2"
        
</pre>
</div>
<p>Taking the gcc -S as a useful tool for reference.</p>
</div>
</li>
<li>
<div class="content" id="cppInlineReferences">
<h3>References</h3>
<div class="featureList">
<ol>
<li><a href="http://www.avr-tutorials.com/assembly/basics-assembly-language">Assembly Language AVR Basic</a></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
