<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<title>Tools&nbsp;Nginx</title>
<meta charset="utf-8">
<meta name="date" content="2018-10-26">
<meta name="keywords" content="">
<meta name="keywords" content="">
<meta name="keywords" content="">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/XRegExp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shCore.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushCpp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushJava.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushJScript.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushBash.js"></script>
<link href="../../syntaxHighlight_css_c/shCore.css" rel="stylesheet" type="text/css" />
<link href="../../syntaxHighlight_css_c/shThemeDefault.css" rel="stylesheet" type="text/css" />

<script src="https://d3js.org/d3.v4.min.js"></script>

</head>
<body>
<script>
SyntaxHighlighter.config.strings.expandSource = '+ expand source';
SyntaxHighlighter.config.strings.help = '?';
SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
SyntaxHighlighter.defaults['pad-line-numbers'] = false;
SyntaxHighlighter.defaults['toolbar'] = false;
SyntaxHighlighter.all()
</script>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<strong>Tools&nbsp;-&nbsp;Nginx</strong>
</div>
<p class="date"><span class="created-date">Created:2018-10-26</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-10-26</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#intro">Introduction</a></li>
<li><a href="#config">Configuration</a></li>
<li><a href="#reference">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="intro">
<h3>Introduction</h3>
<p>Nginx is reverse proxy.</p>
<p>Proxy: complete LAN request to WAN</p>
<p>Reverse proxy: complete WAN request to LAN</p>
</div>
</li>
<li>
    <div class="content" id="config">
        <h3>Configuration</h3>
        <p>Nginx support to hold multiple domains on a single machine. Each domain can be a server, and has a configuration file.</p>
        <h4>Convention</h4>
        <div class="featureList">
            <ol>
                <li>Create config file in the /etc/nginx/sites-available/ directory.</li>
                <li>The name of the configuration file is the domain name. e.g. home.sousys.com</li>
                <li>To enable a site, create a soft link to the /etc/nginx/sites-enabled/ directory</li>
            </ol>
        </div>
        <h4>configuration file</h4>
        <div class="asm">
            <pre>
                server {
                    listen 80;
                    server_name home.sousys.com;
                
                    location /api {
                        proxy_pass http://127.0.0.1:5000;
                    }
                    location /sitemap {
                        root /home/ubuntu/SEO;
                    }
                    location /robots.txt {
                        root /home/ubuntu/SEO;
                    }
                    location / {
                        if ($http_user_agent ~* "Googlebot") {
                            proxy_pass http://localhost:3003;
                                 }
                        if ($http_user_agent ~* "Twitterbot") {
                            proxy_pass http://localhost:3003;
                        }
                        # for an Angular app, the directory is the directory that has the main.html
                        root /home/nan/Documents/angular_app/dist/angular_app;
                        index index.html;
                        try_files $uri $uri/ /index.html  =404;
                    }
                }
            </pre>
        </div>
        
        <div class="featureList">
            <h4>Directive</h4>
            <p>Each "keyword" here, e.g. server, location, and listen are Nginx directives<br>
                Block directive .e.g. server and location and simple directive e.g. listen</p>
            <ol>
                <li>server: Sets configuration for a virtual server</li>
                <li>server_name name
                    <br> e.g. server_name home.sousys.com;
                    <br> # only the request to home.sousys.com will be hold by the server.
                </li>
                <li>listen: ip:port [default_server]
                    <br> listen: 80; 
                    <br># = listen *:80, accept all request to 80 port and also satisfy the server_name
                    <br> listen: 80 default_server; 
                    <br>accept all request to 80 port and if no server_name allow the request, then this server will handle it.
                    <span style="color:red">Only one virtual server can have default_server</span>
                </li>
                <li> location /url {}
                    <br>the url prefix that match the url will be handled by this block.
                    <br><pre>
                        location /sitemap {
                            root /home/ubuntu/SEO;
                        }
                        url = http://home.sousys.com/sitemap/sitemap-1.xml
                        this url will be routed into this block and the file location is /home/ubuntu/SEO + /sitemap/sitemap-1.xml
                    </pre>
                </li>
                <li>root path;
                    <br> the file path prefix
                </li>
                <li>
                    proxy_pass origin;
                    <br>proxy_pass http://localhost:3003; redirect request to this location.
                    <pre>
                        url = http://home.sousys.com/content/page-1.html
                        -> http://localhost:3003/content/page-1.html
                    </pre>
                </li>
            </ol>
        </div>
    </div>
</li>
<li>
<div class="content" id="reference">
<h3>References</h3>
<div class="featureList">
    <ol>
        <li></li>
    </ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
