<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<title>Java&nbsp;Servlet</title>
<meta charset="utf-8">
<meta name="date" content="2018-09-30">
<meta name="keywords" content="">
<meta name="keywords" content="">
<meta name="keywords" content="">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/XRegExp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shCore.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushCpp.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushJava.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushJScript.js"></script>
<script type="text/javascript" src="../../syntaxHighlight_js_c/shBrushBash.js"></script>
<link href="../../syntaxHighlight_css_c/shCore.css" rel="stylesheet" type="text/css" />
<link href="../../syntaxHighlight_css_c/shThemeDefault.css" rel="stylesheet" type="text/css" />

<script src="https://d3js.org/d3.v4.min.js"></script>

</head>
<body>
<script>
SyntaxHighlighter.config.strings.expandSource = '+ expand source';
SyntaxHighlighter.config.strings.help = '?';
SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
SyntaxHighlighter.defaults['pad-line-numbers'] = false;
SyntaxHighlighter.defaults['toolbar'] = false;
SyntaxHighlighter.all()
</script>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<strong>Java&nbsp;-&nbsp;Servlet</strong>
</div>
<p class="date"><span class="created-date">Created:2018-09-30</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2019-10-30</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#intro">Introduction</a></li>
<li><a href="#servlet">Java Servlet</a></li>
<li><a href="#reference">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="intro">
<h3>Introduction</h3>
    <p>Spring Framework is a general Java application framework. It can not only build web application, but also other general applications. The core component of Spring Framework is a IoC (dependency injection) container.</p>
    <p>Spring Framework with Java Servlet together can build web application.</p>
    <p>First release 2002, current version spring framework 5, spring boot 2 (late-2019)</p>
    <h4>Spring Framework vs. Spring Boot</h4>
    <p>Spring Boot is on the top of Spring Framework and eliminates the requirement of spring framework's xml config file. Spring Boot 2.x is based on Spring Framework 5.x, which is based on Java 8.</p>
    <div class="featureList">
        <ol>
            <li>
                <h4>SpringApplication</h4>
                <p>
                    <span class="inline-code">SpringApplication</span> is the launch class.
                    <pre class="brush:java">
                            SpringApplicationBuilder appBuilder = new SpringApplicationBuilder(Config.class)
                                .lazyInitialization(false)
                                .listeners(new ContextInitializedListener()) // add event listener
                                .bannerMode(Banner.Mode.OFF)
                                .web(WebApplicationType.NONE); // non web, servlet (dispatcher), reactive
                            SpringApplication app = appBuilder.build();
                            ApplicationContext ctx = app.run(args);
                    </pre>
                    <p>SprintBoot latest version (2.2.0) support a Fluent API of using builder pattern to generate a SpringApplication instane.</p>
                    <p>The builder can specify/configure:<br>
                        0). configuration class (primary class): it is used to register beans, setup component scan, enable auto configuration ...
                        1). application type: weather starting a web container (e.g. a servlet container [Spring MVC] or a reactive container [Spring WebFlux]), or just run as a general application.<br>
                        2). the behavior of IoC container: lazy or not. By default, lazy is disable, all singleton objects are initialized at the beginning.<br>
                        3). the banner when starting the app.<br>
                        ...
                    </p>
                    <h4>Servlet container vs. Reactive container</h4>
                    <p>Both of them have the same function, listen http requests and dispatch controller. The difference is servlet container uses multi-thread, reactive container uses Node.js like event-loop.</p>
                </p>
            </li>
            <li>
                <h4>ApplicationContext</h4>
                <p>ApplicationContext is the main class provides the core functionality of Spring, which includes
                    1). IoC (dependency injection) container.<br>
                    2). EventPublisher<br>
                    3). MessageSource (to support internationalization)<br>
                    ...
                </p>
                <pre class="brush:java">
                    public interface ApplicationContext extends EnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory,
                        MessageSource, ApplicationEventPublisher, ResourcePatternResolver { // ... }
                </pre>
                <p>There exists different kinds of implementations.<br>
                    <span class="inline-code">AnnotationConfigApplicationContext</span>: A SpringBoot standalone.<br>
                    <span class="inline-code">AnnotationConfigServletWebServerApplicationContext</span>: A SpringBoot with web app with servlet container.
                </p>
                <p>Compared to SpringBoot, Spring Framework uses XML file to initiate the Application Context</p>
                <p class="reference-box">
                    Several implementations of the ApplicationContext interface are supplied with Spring. In stand-alone applications, it is common to create
                     an instance of ClassPathXmlApplicationContext or FileSystemXmlApplicationContext. While XML has been the traditional format for defining 
                     configuration metadata, you can instruct the container to use Java annotations or code as the metadata format by providing a small amount 
                     of XML configuration to declaratively enable support for these additional metadata formats.
                </p>
            </li>
            <li>
                <h4>BeanFactory</h4>
                <p>ApplicationContext extends BeanFactory, which provide methods to get instance of Beans.</p>
                <pre class="brush:java">
                    {
                        boolean containsBean(String name);
                        T getBeans(Class&lt;T> class);
                        Object getBeans(String name);
                        boolean isSingleton(String name);
                    }
                </pre>
            </li>
            <li>
                <h4>CommandLineRunner & ApplicationRunner</h4>
                <p>CommandLineRunner and ApplicationRunner are two beans that will be invoked "run" after the application context is started.</p>
                <pre class="brush:bash">
                    public interface ApplicationRunner{
                        void run(ApplicationArguments args);
                    }
                    public interface CommandLineRunner{
                        void run(String... args);
                    }
                </pre>
            </li>
        </ol>
    </div>
</div>
</li>
<li>
<div class="content" id="servlet">
<h3>Spring with Java Servlet</h3>
<p>JSR 369 defines the specficiation of Java Servlet 4.0</p>
<p>A Java Servelet is a Java program (a set of classes) that 
    <br>1. realizes developer-defined functionality.
    <br>2. implement JSR defines interfaces, e.g. init(), service(), destory(), in order to let servlet container to control it.
</p>
<div class="featureList">
    <ol>
        <li>
            <h4>Servlet Container</h4>
            <p>A servlet container is another Java program that 
                <br>1. receive user request, and convert to a ServletRequest object.
                <br>2. send back response by converting ServletResponse.
                <br>3. Manage java servlet, e.g. dynamic loading, init, destory.
            </p>
            <p>Open source Java EE Servlet Container: Tomcat, Wildfly (JBoss)</p>
        </li>
        <li>
            <h4>Spring Application with Servlet web</h4>
            <pre class="brush:java">
                SpringApplicationBuilder appBuilder = new SpringApplicationBuilder(Config.class)
                    .web(WebApplicationType.SERVLET); 
            </pre>
            <p>Spring will try to find <span class="inline-code">ServletWebServerFactory</span> bean to create and run a servlet container.</p>
            <p>

            </p>
                There two ways to register a servlet factory<br>
                1). With manually defining @Bean in the Configuration class.
                2). Using @EnableAutoConfiguration.
            </p>
            <pre class="brush:java">
                public interface ServletWebServerFactory {
                    WebServer getWebServer(ServletContextInitializer... initializers);
                }
                public class TomcatServletWebServerFactory extends AbstractServletWebServerFactory
		            implements ConfigurableTomcatWebServerFactory, ResourceLoaderAware{
                }
            
                // method 1. inside the config class.
                @Bean
                public ServletWebServerFactory servletFactory(){
                    return new TomcatServletWebServerFactory(9000); // make 9000 as the port
                }

                // method 2
                /**
                * @EnableAutoConfiguration{
                *   @AutoConfigurationPackage{
                *       @Import(value=org.springframework.boot.autoconfigure.AutoConfigurationPackages.Registrar.class)
                *   }
                *   @Import(value=AutoConfigurationImportSelector.class)
                * }
                */
                @EnableAutoConfiguration
                public class Config{

                }
            </pre>
        </li>
    </ol>
</div>
</div>
</li>
<li>
<div class="content" id="reference">
<h3>References</h3>
<div class="featureList">
    <ol>
        <li><a href="https://docs.spring.io/spring-boot/docs/2.2.0.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-application" target="_blank">SpringApplication </a></li>
        <li><a href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/SpringApplication.html" target="_blank">SpringApplication API</a></li>
        <li><a href="../resources/servlet-4_0_FINAL.pdf" target="_blank">Java EE Servlet 4.0 Specification</a></li>
        
    </ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
