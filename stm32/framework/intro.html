<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>Programming&nbsp;Framework</title>
<meta name="date" content="2018-01-19">
<meta name="keywords" content="framework">
<meta name="keywords" content="stm32cube">
<meta name="keywords" content="hal">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>Programming&nbsp;-&nbsp;Framework</strong></center>
</div>
<p class="date"><span class="created-date">Created:2018-01-19</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-01-20</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#frameworkIntro">Introduction</a></li>
<li><a href="#frameworkReferences">Framework</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="frameworkIntro">
<h3>Introduction</h3>
<p>Programming in the relatively complicated 32-bit Cortex-M devices is different from the 8-bit Atmege AVR microcontrollers. Because STM32 deivces have more registers, those registers are 32-bit long instead of 8-bit, and it has more functions, such as DMA,
programming by directly accessing registers is not recommended. Moreover, it is difficult to run the code in different microcontrollers (bad portablity). Therefore, programming STM32 and other cortex-m devices are usually via well-defined libraries.
</p>
<p>Moreover, Cortex-M3 support different operating modes, priviledge/unprivileged instruction, and two stack pointer, which means it has some hardware support for a operating system. Then programming style can treat this device as a simple MCU that does not have those features, or play with those features and perphaps with a RTOS.
In this note, the device is programmed as a simple MCU that only uses the main stack.
</p>
<p>The libraries used to program a STM32 and other cortex-M device are organized as a layered architecture.</p>
<div class="featureList">
<h4>Pros and Cons about the layered architecture</h4>
<ol>
<li>+ hide complexity</li>
<li>+ modularity (good for portable)</li>
<li>- calling overhead: have to go through each layer.</li>
</ol>
</div>
<div class="featureList">
<h4>Layers in programming stm32</h4>
<ol>
<li>mbed-os (provided by mbed (ARM), a suite of API, such as Ethernet, GPIO, ...)</li>
<li>mbed HAL (collaborated by mbed (ARM) and vendor, defines a hardware abstraction layer to hide the difference of devices' configuration)</li>
<li>STM32 standard peripherals library(provided by ST, defines the peripherals registers (e.g. GPIO, flash), data structure</li>
<li>CMSIS (provided by ARM, defines the registers of the core, interrupts, data structure, compiling convention... e.g. core_cm3.h</li>
</ol>
</div>
<p>As a developer, we can start from any layer.</p>
<div class="featureList">
<h4>Working flow</h4>
<p>To do a project, following steps are necessary. Each step would has its own tools.</p>
<ol>
<li>
<p>Create a project and write the code (Tools: STM32CubeMX, or Keil, or mbed)</p>
<p>Before creating a project, the starting layers have to be decided. 
<div class="featureList">
<ol>
<li>mbed: a browser-based online IDE. It creats a project that uses the mbed-os library.</li>
<li>STM32CubeMX: a GUI tools that initializes a project structures including the makefile.</li>
<li>Keli: Keli provides some examples that starts from the STM32 standard peripheral layer.</li>
</ol>
</div>
</p>
</li>

<li><p>Compile</p><p>Compilation is done by GCC ARM Embedded Toochains (gcc-arm-none-eabi)</p></li>
<li>
<p>Download to a device</p>
<div class="featureList">
<ol>
<li>Via ST-Link:stlink will behave as a u-disk, just copy the .bin (raw binary) to it.</li>
<li>openocd:<p style="color:red;">TO DO</p></li>
</ol>
</div>

</li>
<li>Debug: <p style="color:red;">TO DO</p></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
