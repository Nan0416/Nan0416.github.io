<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Sun Oct 08 22:41:36 PDT 2017 -->
<title>Basic&nbsp;Micro-architecture</title>
<meta charset="utf-8">
<meta name="date" content="2018-01-20">
<meta name="keywords" content="arm">
<meta name="keywords" content="cortex-m">
<meta name="keywords" content="stm32">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ======= -->
<div class="bar">
<center><strong>Basic&nbsp;-&nbsp;Micro-architecture</strong></center>
</div>
<p class="date"><span class="created-date">Created:2018-01-20</span>&nbsp;&nbsp;<span class="last-modified">Last modified:2018-01-20</span></p>
<div class="catalog">
<ul class="catalogItems">
<li><a href="#microArchIntro">Introduction</a></li>
<li><a href="#microArchComp">Cortex-M3 components</a></li>
<li><a href="#microArchReference">References</a></li>
</ul>
</div>
<hr>
<div class="contentContainer">
<ol>
<li>
<div class="content" id="microArchIntro">
<h3>Introduction</h3>
<p>The micro-architecture is a processor, the MCU core, that implements an specific architecture. It may also add some other features and components, such as an interrupt controller, a memory protecture unit (MPU), external bus interfaces.</p>
<p>For example, the Cortex-M3 processor (STM32F10x core) implements the on ARMv7-M architecture. Based on ARMv7-M, it defines #pipeline, . Moreover, it also has a nested vectored interrupt controller (NVIC), a MPU, a couple of bus interface.</p>
<p><img src="./img/core.png" width="300" height="200"></p>
</div>
</li>
<li>
<div class="content" id="microArchComp">
<h3>Cortex-M3 configuration and components</h3>
<div class="featureList">
<ol>
<li>
<h4>Programming Mode</h4>
<p>It support two operating modes. The operating mode is different from the privileged and unprivileged mode. In the thread mode, code can be executed as privileged or unprivileged. So the [un]privileged is under the thread mode.
It also has two stacks that are pointed by two stack pointer registers, main stack and process stack. But the two registers are banked register, which means they has the same address.</p>
</p>



<div class="termnology">
<ul>
<li>Thread mode: entered on Reset, and can be entered as a result of an exception return. (code is under either privileged or unprivileged execution)</li>
<li>Handler mode: entered as a result of an exception. (code is under privilege execution, which means all instructions can be used)</li>
<li>Main stack: after reset all code (main and handler) uses this main stack.</li>
<li>Process stack: after reture from an handler with a special EXC_RETURN value, the main program will use the process stack.</li>
</ul>
<p class="starMark">* The privileged thread mode that use main stack is similar to run a program in a MCU that does not have these features, e.g. Atmega328p.</p>
<p><img src="./img/mode.png" width="500" height="250"></p>
<p><img src="./img/stack.png" width="500" height="250"></p>
</div>
<div class="termnology">
<h4>Term</h4>
<ul>
<li>Banked register: multiple registers that have the same address. Using which register is determined by current suition. For example, UART data register is actually two registers that are banked together. The read/write operation refer same address but different physical registers.</li>
</ul>
</div>
</li>
<li>
<h4>NVIC (Nested Vectored Interrupt controller)</h4>
<p>The NVIC control interrupt and exception (software?), it can support 240 interrupt source and 256 level of priority </p>
</li>
</ol>
</div>
</div>
</li>
<li>
<div class="content" id="microArchReference">
<h3>References</h3>
<div class="featureList">
<ol>
<li><a href="./cortexM3.pdf" target="_blank">Cortex-M3 Technical Reference Manual</a></li>
</ol>
</div>
</div>
</li>
</ol>
</div>
    
</body>
</html>
